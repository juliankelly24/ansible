---
  vars:
    julian: "{{ lookup('file', '/opt/aaf/repo/pub_keys/julian.pub') }}"
    dalia: "{{ lookup('file', '/opt/aaf/repo/pub_keys/dalia.pub') }}"
    terry: "{{ lookup('file', '/opt/aaf/repo/pub_keys/terry.pub') }}"
    melroy: "{{ lookup('file', '/opt/aaf/repo/pub_keys/melroy.pub') }}"
    ec2: "{{ lookup('file', '/home/ec2-user/.ssh/authorized_keys') }}"
  
  users:
  
  - username: julian
    use_sudo: yes
    
  - username: dalia
    use_sudo: yes
 
  - username: terry
    use_sudo: yes
 
  - username: melroy
    use_sudo: yes
  
  tasks:
  
  - name: Add users | create users, shell, home dirs
    user: name={{ item.username }} shell=/bin/bash createhome=yes comment='create with ansible'
    with_items: '{{users}}'

  - name: Setup | authorized key upload
    authorized_key: user={{ item.username }}
      key="{{ lookup('file', 'pub_keys/{{ item.username }}.pub') }}"
