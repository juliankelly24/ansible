---
- name: set timezone to Austalia/Brisbane
  timezone:
    name: Australia/Brisbane

- name: Install Packages
  yum: pkg={{ item }} state=installed
  with_items:
    - httpd
    - mod_ssl
    - ntp
    - htop

- name: Create Virtualhost File
  action: file path=/etc/httpd/conf.d/virtualhosts.conf state=touch mode=0644

- name: Config Apache
  blockinfile:
    path: /etc/httpd/conf.d/virtualhosts.conf
    block: |
      NameVirtualHost *:80
      NameVirtualHost *:443
      <VirtualHost *:80>
          DocumentRoot /var/www/html
          <Directory "/var/www/html/">
            Options -Indexes FollowSymLinks
            AllowOverride All
            DirectoryIndex index.html index.htm index.php
          </Directory>
      </VirtualHost>

- include: apache.yml
#- include: tasks/firewalld.yml

- name: on apache
  action: command /sbin/chkconfig httpd on
- name: check apache
  action: service name=httpd state=started
- name: set permission
  file: path=/var/www/html owner=root group=root mode=0777 force=yes state=directory
